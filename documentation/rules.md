# Правила разработки Python-приложений для ИИ-ассистентов

## 1. Инициализация проекта и управление средой

### 1.1 Создание виртуальной среды
- Перед началом любого нового проекта необходимо создать изолированную среду
- Запросить у пользователя:
  - Название проекта/среды
  - Предпочитаемый тип среды (conda/venv)
  - Требуемую версию Python
- Предоставить команды для создания среды:
  ```bash
  # Для venv
  python -m venv [название_среды]
  
  # Для conda
  conda create --name [название_среды] python=[версия]
  ```

### 1.2 Управление зависимостями
- Создать requirements.txt или environment.yml в корне проекта
- Документировать все зависимости с указанием версий
- Предлагать минимально необходимый набор зависимостей

## 2. Структура проекта

### 2.1 Планирование структуры
- Перед началом разработки предложить детальную структуру проекта
- Разделять код на логические модули
- Базовая структура проекта:
```
project_name/
├── docs/
├── src/
│   ├── __init__.py
│   ├── data/
│   ├── models/
│   ├── utils/
│   └── visualization/
├── tests/
├── README.md
├── requirements.txt
└── .gitignore
```

### 2.2 Модульность
- Каждый модуль должен иметь единственную ответственность
- Использовать относительные импорты внутри проекта
- Документировать назначение каждого модуля

## 3. Визуализация

### 3.1 Streamlit как основной фреймворк
- Использовать Streamlit для веб-интерфейса по умолчанию
- Базовая структура Streamlit-приложения:
```python
import streamlit as st
import plotly.express as px
import plotly.graph_objects as go

def main():
    st.title("Название приложения")
    # Основная логика
    
if __name__ == "__main__":
    main()
```

### 3.2 Plotly для визуализации
- Использовать Plotly для создания интерактивных графиков
- Предпочитать Plotly Express для простых визуализаций
- Использовать Plotly Graph Objects для сложных кастомных графиков
- Всегда добавлять подписи осей и легенду

## 4. Управление изменениями

### 4.1 Модификация кода
- Сохранять предыдущие версии функций в комментариях
- Использовать условные комментарии для отключенного кода:
```python
# OLD_VERSION
# def some_function():
#     old_implementation

# NEW_VERSION
def some_function():
    new_implementation
```

### 4.2 Правила обновления
- Не удалять существующий код без явного разрешения пользователя
- При модификации функции сначала показать изменения
- Предлагать альтернативные варианты реализации
- Сохранять историю изменений в комментариях

## 5. Обработка данных

### 5.1 Валидация входных данных
- Проверять типы входных данных
- Обрабатывать краевые случаи
- Предоставлять понятные сообщения об ошибках

### 5.2 Работа с данными
- Использовать pandas для обработки табличных данных
- Документировать предобработку данных
- Создавать промежуточные чекпоинты для больших датасетов

## 6. Документация

### 6.1 Документирование кода
- Использовать docstrings для всех функций и классов
- Следовать Google Style Python Docstrings
- Пример документации:
```python
def process_data(df: pd.DataFrame, column: str) -> pd.DataFrame:
    """
    Обрабатывает данные в указанном столбце.

    Args:
        df (pd.DataFrame): Входной датафрейм
        column (str): Название столбца для обработки

    Returns:
        pd.DataFrame: Обработанный датафрейм
    """
```

### 6.2 README
- Создавать подробный README.md
- Включать инструкции по установке и запуску
- Документировать все зависимости

## 7. Тестирование

### 7.1 Базовое тестирование
- Создавать базовые тесты для критических функций
- Использовать pytest для тестирования
- Включать примеры использования в тестах

### 7.2 Обработка ошибок
- Использовать try-except для обработки исключений
- Логировать ошибки
- Предоставлять понятные сообщения пользователю

## 8. Безопасность

### 8.1 Конфиденциальные данные
- Использовать .env файлы для хранения секретов
- Не хардкодить чувствительные данные
- Добавлять конфиденциальные файлы в .gitignore

### 8.2 Валидация ввода
- Проверять пользовательский ввод
- Использовать параметризованные запросы для SQL
- Ограничивать доступ к системным ресурсам

## 9. Производительность

### 9.1 Оптимизация
- Использовать векторизованные операции pandas
- Применять генераторы для больших наборов данных
- Профилировать код при необходимости

### 9.2 Кеширование
- Использовать st.cache для Streamlit
- Кешировать тяжелые вычисления
- Сохранять промежуточные результаты

## 10. Git-практики

### 10.1 Управление версиями
- Инициализировать git-репозиторий
- Создавать осмысленные коммиты
- Использовать ветки для новых функций

### 10.2 .gitignore
```
__pycache__/
*.pyc
.env
.venv/
*.log
```